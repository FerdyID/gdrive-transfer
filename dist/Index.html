<?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?> <html> <head>  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script>WebFont.load({
        google: {
          families: ['Lato']
        }
      });</script> </head> <body>  <div id="holdon">Just a moment...</div> <div id="screen"></div>  <div class="modal fade" id="dialog-message" tabindex="-1" role="dialog" aria-labelledby="Copy Sharing Permissions"> <div class="modal-dialog" role="document"> <div class="modal-content">  <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="dialog-title">Copy Sharing Permissions</h4> </div>  <div class="modal-body"> <p> Selecting this box will create the new folder/sub-folders/documents with the same sharing permissions (e.g. "Edit", "View") as the original documents. </p> Notes: <ul> <li>Anyone that was an owner of the original document/folder will simply be given "Edit" rights. If you need to transfer ownership of the folder, please see my <a href="https://chrome.google.com/webstore/detail/transfer-ownership/ndbdlpeegehlbhgnpifancfbnnehoofa" target="_blank">Transfer Ownership</a> tool.</li> <li>This will send <b><i>several</i></b> emails to each owner, editor and viewer. Please <b><i>do not</i></b> select this option if the emails will annoy your collaborators.</li> <li>It will take slightly longer to copy the folder with this option enabled</li> </ul> </div>  <div class="modal-footer"> <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button> </div> </div> </div> </div>  <div class="container" id="container"> <h1> Transfer ownership of a google drive folder, including all sub-folder and all its contents <br> </h1> <div id="description"> Just input the folder sharing url and a new owner email, and it will transfer ownership of the folder, including all sub-folders and contents, to the new user.<br> This app will recursively trace the folder structure, and is designed to work well for deep folder structures.<br> To select the folder to transfer:: <ol> <li>Find the folder in your Google Drive</li> <li>Right click your folder</li> <li>Select ''Get link'' and press CTRL-C to copy</li> </ol> OR <ol> <li>Open the folder in Google Drive</li> <li>Copy the URL from the browser address bar</li> </ol> <br> </div> <div id="important"> NOTE: In order for the ownership transfer to work, you must first: <ol> <li>Share the top folder with the new owner</li> <li>The new owner must add the folder to their Drive</li> <ol> <li>Navigate to "Shared with me"</li> <li>Right-click the shared folder and select "Add to My Drive"</li> </ol> </ol> Once both of these steps are complete, <b><i>then</i></b> use this app to transfer all the sub-folders. </div> <div id="dialog-confirm" title="Heads up!"> </div> <div class="hidden" id="error-message"> Verify that you have permission to access this folder and that the specified folder ID (if any) is correct. </div>  <div id="formDiv"> <form id="thisForm" name="thisForm" class="form-horizontal"> <div class="form-group"> <label for="folderId" class="col-sm-3 control-label">Folder to copy<br>(input <b>folder url</b>)</label> <div class="col-sm-9"> <input type="textbox" id="folderId" name="folderId" class="form-control" placeholder="Folder ID"> </div> </div> <div class="form-group"> <label for="newOwner" class="col-sm-3 control-label">New owner email</label> <div class="col-sm-9"> <input type="textbox" id="newOwner" name="newOwner" class="form-control" placeholder="New owner email"> </div> </div> <div class="form-group"> <div class="col-sm-offset-3 col-sm-9"> <button type="submit" id="transferFolderButton" data-loading-text="Transferring..." class="btn btn-primary" autocomplete="off">Transfer folder</button> </div> </div> </form> </div>  <div id="complete" class="alert alert-success" role="alert"> Transfer of ownership complete! </div> <div id="please-review" class="panel panel-default"> <div class="panel-heading">Have an extra 30 seconds?</div> <div class="panel-body"> Please take a moment to <a href="https://chrome.google.com/webstore/detail/copy-folder/kfbicpdhiofpicipfggljdhjokjblnhl/reviews" target="_blank">rate and review this app</a> in the Chrome Web Store. </div> </div>  <div id="errors"></div> <div id="status"> <div class="panel panel-default"> <div class="panel-heading"> <div class="panel-title"> <h4 id="status-title">Copying folder structure <i class="fa fa-spinner fa-spin"></i></h4> </div> </div> <div class="panel-body"> <table id="status-table" class="table table-striped"> <tr> <th>Folder path</th> <th>Status</th> </tr> </table> </div> </div> </div> <div id="troubleshooting"> <b>New owner can't find the folder?</b> Search for the folder name in their Google Drive, and find the folder in the search results. Right click the folder and select "Add to My Drive". The folder should now be added to their Google Drive.<br> If you're having trouble, tell them to follow the below link and add it to their drive:<br> </div> </div>  <footer class="footer"> <div class="container-fluid"> <div class="row">  <div class="col-sm-offset-2 col-sm-2"> <b>Copy a folder</b><br> Check out <a href="https://chrome.google.com/webstore/detail/copy-folder/kfbicpdhiofpicipfggljdhjokjblnhl" target="_blank">my other project</a> </div>  <div class="col-sm-2"> <b>Source code</b><br> <a href="https://github.com/ericyd/gdrive-transfer" target="_blank">Github</a> </div>  <div class="col-sm-2"> <b>Developer's website</b><br> <a href="http://ericyd.com" target="_blank">ericyd.com</a> </div>  <div class="col-sm-2"> <b>Comments? Questions? Concerns?</b><br> eric@ericyd.com </div> </div> </div> </footer> </body> </html>  <?!= HtmlService.createHtmlOutputFromFile('js').getContent(); ?>