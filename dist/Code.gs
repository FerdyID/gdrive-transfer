function doGet(e){var t=HtmlService.createTemplateFromFile("Index");return t.thisForm=e.parameter.thisForm,t.evaluate().setTitle("Transfer ownership for a Google Drive folder").setSandboxMode(HtmlService.SandboxMode.IFRAME)}function getValues(e){var t=e.folderId,r=DriveApp.getFolderById(t),a=r.getName(),n=e.newOwner,g=[];return g.push(t),g.push(n),g.push(a),g}function getFolders(e,t,r){var a=DriveApp.getFolderById(e);a.addEditor(r);for(var n=a.getFolders();n.hasNext();){var g=n.next(),o=getFullPath("",g.getId());o+=g.getName();var s=[];s.push(g.getId()),s.push(o),t.push(s),g.getFolders().hasNext()&&getFolders(g.getId(),t)}return t}function transferFolder(e,t){var r=DriveApp.getFolderById(e),a=r.getName(),n=Session.getActiveUser().getEmail();return r.getOwner().getEmail()==n&&r.setOwner(t),a}function transferFiles(e,t){for(var r=DriveApp.getFolderById(e),a=r.getName(),n=r.getFiles(),g=Session.getActiveUser().getEmail();n.hasNext();){var o=n.next();o.getOwner().getEmail()==g&&o.setOwner(t)}return a}function getFullPath(e,t){var r=DriveApp.getFolderById(t).getParents(),a=r.next();return"My Drive"!=a.getName()&&(e=a.getName()+" > "+e,a.getParents().hasNext()&&(e=getFullPath(e,a.getId()))),e}